---
title: "p8105_hw2_cd3591"
author: "Anny"
date: "2025-09-29"
output: github_document
---

```{r}
# setup library
library(tidyverse)
library(readxl)
```

# Problem 1
```{r}
# read the pols-month data and clean it
pols_data = read_csv("pols-month.csv") %>%  
  janitor::clean_names() %>%
  separate(mon, into = c("year", "month", "day"), sep = "-") %>%  # separate mon into year, month and day by "-"
  mutate(year = as.integer(year),  # change year (character) variable into integer
         month = as.integer(month),  # change month (character) variable into integer
         day = as.integer(day), # change day (character) variable into integer
         month = month.name[month],  # replace month number with month name 
         president = if_else(prez_gop == 1, "gop", "dem") # create president variable taking values gop and dem
         ) %>%
  select(-prez_dem, -prez_gop, -day)  # remove prez_dem and prez_gop and the day variable

```

```{r}
# read the snp data and clean it
snp_data = read_csv("snp.csv") %>%
  janitor::clean_names() %>%
  mutate(date  = mdy(date),  # make the date into standard version
         date = if_else(date > Sys.Date(), date %m-% years(100), date)) %>%   # e.g. let 2068 into 1968
  separate(date, into = c("year", "month", "day"), sep = "-") %>%  # separate date into month, day and year by "-"
  mutate(year = as.integer(year),  # change year (character) variable into integer
         month = as.integer(month),  # change month (character) variable into integer
         day = as.integer(day), # change day (character) variable into integer
         month = month.name[month]  # replace month number with month name
         ) %>%
  select(-day) %>%  # remove the day variable
  relocate (year, month)  # make sure year and month are the leading columns
  
```

```{r}
# read the unemployment data and tidy it
unemployment_data = read_csv("unemployment.csv") %>%
  janitor::clean_names() %>%
  pivot_longer(
    -year, names_to = "month", values_to = "unemployment"  
    #except year variable, tidy names into month variable and values into unemployment variable
  ) %>%
  mutate(
    month = str_to_title(month), # capitalize the first letter of the month to match other datasets
    month = month.name[match(month, month.abb)]  # e.g. let "Jan" -> "January"
  )

# merge the datasets
merged_data = pols_data %>%
  left_join(snp_data, by = c("year", "month")) %>%
  left_join(unemployment_data, by = c("year", "month"))

```

```{r}
# export the cleaned datasets and the merged dataset
readr::write_csv(merged_data,   "merged_data.csv")
readr::write_csv(pols_data,     "pols_data.csv")
readr::write_csv(snp_data,      "snp_data.csv")
readr::write_csv(unemployment_data,  "unemployment_data.csv")
```

Description: 
pols_data.csv has 822 rows × 9 columns (year 1947-2015) with monthly counts of officeholders by party: gov_gop, sen_gop, rep_gop, gov_dem, sen_dem, rep_dem, plus the president variable indicates whether the president was democratic or republican on the associated date (dem = democratic; gop = republican). snp_data.csv has 787 × 3 (year 1950–2015) with year, month, close (the closing values of the S&P stock index). unemployment_data.csv has 816 × 3 (year 1948–2015) with year, month, unemployment (percentage of unemployment on the associate date). After merging all data sets, merged_data.csv contains 822 rows × 11 columns, spanning 1947–2015. Key variables are year, month, gov_gop, sen_gop, rep_gop, gov_dem, sen_dem, rep_dem, president, close, and unemployment (%). 

# Problem 2
```{r}
# read the Mr. Trash Wheel data
mr = read_excel("202409 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", range = "A2:N655", col_names = TRUE,
  na = c("", "NA")) %>% # omit non-data entries
  janitor::clean_names() %>%  # use reasonable variable names
  janitor::remove_empty(c("rows","cols")) %>%  # drop empty rows or columns
  filter(!is.na(dumpster)) %>%  # omit rows that do not include dumpster-specific data
  mutate(sports_balls = as.integer(round(as.numeric(sports_balls))),  
         #round the number of sports balls to the nearest integer and converts the result to an integer variable
         wheel = "Mr. Trash Wheel"  #keep track of Mr. Trash Wheel
         )  
         

# read the Professor Trash Wheel data
professor = read_excel("202409 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", range = "A2:M123", col_names = TRUE,
  na = c("", "NA")) %>% # omit non-data entries
  janitor::clean_names() %>%  # use reasonable variable names
  janitor::remove_empty(c("rows","cols")) %>%  # drop empty rows or columns
  filter(!is.na(dumpster)) %>%  # omit rows that do not include dumpster-specific data
  mutate(wheel = "Professor Trash Wheel")  #keep track of Professor Trash Wheel

# read the Gwynnda Trash Wheel data
gwynnda = read_excel("202409 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", range = "A2:L266", col_names = TRUE,
  na = c("", "NA")) %>% # omit non-data entries
  janitor::clean_names() %>%  # use reasonable variable names
  janitor::remove_empty(c("rows","cols")) %>%  # drop empty rows or columns
  filter(!is.na(dumpster)) %>%  # omit rows that do not include dumpster-specific data
  mutate(wheel = "Gwynnda Trash Wheel")  #keep track of Gwynnda Trash Wheel

```